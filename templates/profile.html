<!DOCTYPE html>
<html>
<head>
  <title>Profile</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<div class="form-box">
  <h2>User Profile</h2>

  <p><strong>Username:</strong> {{ user.username }}</p>
  <p><strong>Email:</strong> {{ user.email }}</p>
  <p><strong>Role:</strong> {{ user.role }}</p>
  {% if user.department %}
    <p><strong>Department:</strong> {{ user.department }}</p>
  {% endif %}

  <!-- ✅ Edit Button to Show Form -->
  <button onclick="toggleEditForm()" class="btn btn-primary">✏️ Edit Username</button>

  <!-- ✅ Hidden Edit Username Form -->
  <form id="editForm" action="{{ url_for('edit_profile') }}" method="POST" style="display: none; margin-top: 15px;">
    <label for="username">New Username</label>
    <input type="text" id="username" name="username" value="{{ user.username }}" required>
    <button type="submit">Save</button>
    <button type="button" onclick="toggleEditForm()">Cancel</button>
  </form>

  <br><br>
  <a href="{{ url_for('dashboard') }}">← Back to Dashboard</a>
</div>

<script>
  function toggleEditForm() {
    const form = document.getElementById("editForm");
    form.style.display = form.style.display === "none" ? "block" : "none";
  }

  function toggleDropdown() {
    var menu = document.getElementById("dropdownMenu");
    menu.style.display = (menu.style.display === "block") ? "none" : "block";
  }

  window.onclick = function(event) {
    if (!event.target.matches('.profile-icon')) {
      var dropdowns = document.getElementsByClassName("dropdown-menu");
      for (var i = 0; i < dropdowns.length; i++) {
        dropdowns[i].style.display = "none";
      }
    }
  }
</script>
</body>
</html>
